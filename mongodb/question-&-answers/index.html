<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="icon" type="image/png" href="../js.png">
        <title>MONGODB Q&A</title>
        <style>
            body {
                font-family: 'Segoe UI', sans-serif;
                background-color: #f9f9f9;
                padding: 20px;
            }

            .qa-container {
                max-width: 800px;
                margin: auto;
            }

            .qa-item {
                margin-bottom: 15px;
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                background-color: #fff;
                transition: all 0.3s ease;
            }

            .question {
                padding: 15px 20px;
                background-color: #007BFF;
                color: white;
                cursor: pointer;
                font-weight: bold;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .question:hover {
                background-color: #0056b3;
            }

            .question::after {
                content: '+';
                font-size: 18px;
                transition: transform 0.3s ease;
            }

            .question.active::after {
                content: '‚àí';
            }

            .answer {
                max-height: 0;
                overflow: hidden;
                padding: 0 20px;
                background-color: #f4f4f4;
                transition: max-height 0.5s ease, padding 0.3s ease;
            }

            .answer.show {
                max-height: 500px; /* Enough for most answers */
                padding: 15px 20px;
                overflow-y: auto;
            }
            .answer ul {
                list-style-type: disc;
                padding-left: 20px;
            }
            .answer ul> li {
                margin-bottom: 10px;
                
            }
            .answer h4 {
                margin-top: 10px;
                margin-bottom: 5px;
            }
            .answer pre {
                background-color: #e8e8e8;
                padding: 10px;
                border-radius: 5px;
                overflow-x: auto;
            }
            table> thead > tr > th {
                text-align: left;
            }
            th, td {
                border: 1px solid black;
                padding: 5px;
            }
        </style>
    </head>
    <body>
        <div class="qa-container">
            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What is MongoDB, and how is it different from relational databases like MySQL or PostgreSQL?
                </div>
                <div class="answer">
                    MongoDB is a NoSQL, open-source, document-oriented database that stores data in a flexible, JSON-like format
                    <p>
                        <h4>Key Differences</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Features</th>
                                    <th>MongoDB</th>
                                    <th>MySQL/PostgreSQL</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Data Model</td>
                                    <td>Document-oriented (JSON-like)</td>
                                    <td>Table-oriented (rows & columns)</td>
                                </tr>
                                <tr>
                                    <td>Schema</td>
                                    <td>Schema-less (fields can vary from document to document)</td>
                                    <td>Fixed schema (all rows must follow the same structure)</td>
                                </tr>
                                <tr>
                                    <td>Data Storage</td>
                                    <td>BSON documents in collections</td>
                                    <td>Rows in tables</td>
                                </tr>
                                <tr>
                                    <td>Joins</td>
                                    <td>Limited join support (via $lookup)</td>
                                    <td>Full join operations (INNER, LEFT, RIGHT, etc.)</td>
                                </tr>
                                <tr>
                                    <td>Scaling</td>
                                    <td>Horizontal scaling (sharding)</td>
                                    <td>Mostly vertical scaling (replication & partitioning possible)</td>
                                </tr>
                                <tr>
                                    <td>Transactions</td>
                                    <td>Supports multi-document ACID transactions (since MongoDB 4.0)</td>
                                    <td>Full ACID compliance from the start</td>
                                </tr>
                            </tbody>
                        </table>
                    </p>

                    <h4>NOTE:</h4>
                    <ul>
                        <li>In MySQL: users table ‚Üí each row has id, name, email, etc.</li>
                        <li>In MongoDB: users collection ‚Üí each document can have different fields. One document may have "phone", another may not.</li>
                    </ul>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    Explain the concept of a document in MongoDB.
                </div>
                <div class="answer">
                    <ul>
                        <li>A document in MongoDB is the basic unit of data.</li>
                        <li>It is stored in BSON format (Binary JSON) and is similar to a JSON object.</li>
                        <li>Think of a document like a row in MySQL, but more flexible ‚Äî it can have nested data and arrays.</li>
                    </ul>
                    <h4>Example</h4>
                    <pre>
{
    "_id": ObjectId("64c34f3f1a3b5e4567abc123"),
    "name": "Alice",
    "email": "alice@example.com",
    "age": 28,
    "skills": ["JavaScript", "MongoDB", "Node.js"],
    "address": {
        "city": "Delhi",
        "country": "India"
    }
}
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What is a collection in MongoDB?
                </div>
                <div class="answer">
                    <ul>
                        <li>A collection is a group of MongoDB documents, similar to a table in RDBMS.</li>
                        <li>Collections do not enforce a fixed schema</li>
                        <li>Documents in the same collection can have different fields.</li>
                    </ul>
                    
                    <h4>Example</h4>
                    <pre>
{ "name": "Alice", "email": "alice@example.com" }
{ "name": "Bob", "age": 30, "skills": ["Node.js", "React"] }
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What are BSON and JSON, and how are they related in MongoDB?
                </div>
                <div class="answer">
                    <h4>JSON (JavaScript Object Notation): </h4>
                    <p>A human-readable text format for storing structured data.</p>

                    <h4>BSON (Binary JSON): </h4>
                    <ul>
                        <li>A binary-encoded format used by MongoDB for storage and network transfer</li>
                        <li>Supports all JSON types.</li>
                        <li>Adds extra types not in JSON (like Date, ObjectId, Decimal128).</li>
                        <li>Faster for parsing and more efficient in storage.</li>
                    </ul>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What does the $set operator do?
                </div>
                <div class="answer">
                    <p>The $set operator is used to update (or add if missing) specific fields in a document without replacing the whole document.</p>

                    <h4>Example: </h4>
                    <pre>
db.users.updateOne(
    { name: "Bob" },
    { $set: { city: "Delhi" } }
);
                    </pre>
                    <p><strong>NOTE:</strong>
                        Without $set, MongoDB would replace the entire document.
                    </p>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    How do you use query operators like $gt, $lt, $in, $or in MongoDB queries?
                </div>
                <div class="answer">
                    <p>
                        <h4>Key Differences</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Operator</th>
                                    <th>Meaning</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>$gt</td>
                                    <td>Greater than</td>
                                    <td>{ age: { $gt: 25 } } ‚Üí age > 25</td>
                                </tr>
                                <tr>
                                    <td>$lt</td>
                                    <td>Less than</td>
                                    <td>{ age: { $lt: 30 } } ‚Üí age < 30</td>
                                </tr>
                                <tr>
                                    <td>$in</td>
                                    <td>Matches any value in array</td>
                                    <td>{ city: { $in: ["Delhi", "Mumbai"] } }</td>
                                </tr>
                                <tr>
                                    <td>$or</td>
                                    <td>OR condition</td>
                                    <td>{ $or: [ { age: 25 }, { city: "Delhi" } ] }</td>
                                </tr>
                            </tbody>
                        </table>
                    </p>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What is an index in MongoDB, and why is it important?
                </div>
                <div class="answer">
                    <p>
                        An index in MongoDB is a special data structure that stores a small portion of the collection‚Äôs data in a way that makes searching faster.
                    </p>
                    <ul>
                        <li>By default, MongoDB creates an index on _id for every collection.</li>
                        <li>Without an index ‚Üí MongoDB does a collection scan (checks every document).</li>
                        <li>With an index ‚Üí MongoDB can directly look up matching documents.</li>
                    </ul>

                    <h4>Example:</h4>
                    <pre>
// Create an index on 'age' field
db.users.createIndex({ age: 1 });

// Query is now faster
db.users.find({ age: 25 });
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What are the types of indexes supported in MongoDB?
                </div>
                <div class="answer">
                    <p>
                        MongoDB supports several index types:
                    </p>
                    
                    <pre>
1. <b>Single-field index</b> ‚Üí Index on one field.
    db.users.createIndex({ age: 1 });

2. <b>Compound index</b> ‚Üí Index on multiple fields (order matters).
    db.users.createIndex({ age: 1, city: -1 });

3. <b>Multikey index</b> ‚Üí Index on array fields (each element is indexed).
    db.users.createIndex({ skills: 1 }); //{ skills: ["Node.js", "MongoDB"] }

4. <b>Text index</b> ‚Üí For full-text search (words, phrases).
    db.articles.createIndex({ content: "text" });

5. <b>Hashed index</b> ‚Üí Indexes hashed values (useful for sharding).
    db.users.createIndex({ email: "hashed" });

6. <b>Geospatial index</b> ‚Üí For location-based queries (2d, 2dsphere).
    db.places.createIndex({ location: "2dsphere" });
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    How does compound indexing work?
                </div>
                <div class="answer">
                    <ul>
                        <li>A compound index is an index on multiple fields.</li>
                        <li>The order matters ‚Üí the index { age: 1, city: 1 } can be used for queries starting with age, but not for queries that only filter on city.</li>
                    </ul>
                    
                    <h4>Example:</h4>
                    <pre>
db.users.createIndex({ age: 1, city: 1 });

This index supports queries like:
{ age: 25 }
{ age: 25, city: "Delhi" }
{ age: { $gt: 20 }, city: "Mumbai" }
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What is a text index, and how do you create one?
                </div>
                <div class="answer">
                    <ul>
                        <li>A text index allows searching for words and phrases in string fields.</li>
                        <li>Only one text index per collection</li>
                        <li>When you use a text index in MongoDB, the database doesn‚Äôt just do a literal string match ‚Äî it applies natural language processing (NLP) techniques behind the scenes:</li>
                            <strong>Stemming:</strong>
                            <p>MongoDB reduces words to their root form so that variations of a word match the same way.</p>
                            <h4>Example:</h4>
                            <pre>
If your document has "running" and you search for "run", it will match.

"developer" and "developing" both stem to "develop".
                            </pre>

                            <strong>Stop words:</strong>
                            <p>Common words like "the", "a", "is", "and" are ignored in text searches because they don‚Äôt add much meaning.</p>
                            <h4>Example:</h4>
                            <pre>
Searching for "the best database" is treated more like "best database".
                            </pre>
                        
                    </ul>
                    
                    <h4>Text Index Example:</h4>
                    <pre>
db.articles.createIndex({ content: "text" });

// Search documents containing "mongodb"
db.articles.find({ $text: { $search: "mongodb" } });
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What is an index cardinality?
                </div>
                <div class="answer">
                    <ul>
                        <li>Index cardinality = Number of unique values in an indexed field.</li>
                        <li>High cardinality ‚Üí Many unique values (e.g., email).</li>
                        <li>Low cardinality ‚Üí Few unique values (e.g., gender ‚Üí "M" / "F").</li>
                        <li>Indexes are most effective on high-cardinality fields.</li>
                        <li>Indexing low-cardinality fields often doesn‚Äôt improve performance.</li>
                    </ul>

                    <h4>üìå Example:</h4>
                    <pre>
Index on email (high cardinality) ‚Üí very useful.

Index on gender (low cardinality) ‚Üí not very useful.
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What is the explain plan, and how do you use it to optimize queries?
                </div>
                <div class="answer">
                    <p>The explain plan shows how MongoDB executes a query ‚Äî whether it used an index or did a full collection scan.</p>

                    <h4>üìå Example:</h4>
                    <pre>
db.users.find({ age: 25 }).explain("executionStats");
                    </pre>

                    <h4>Key parts of the output:</h4>
                    <ul>
                        <li>"COLLSCAN" ‚Üí Collection scan (slow).</li>
                        <li>"IXSCAN" ‚Üí Index scan (fast).</li>
                        <li>"executionTimeMillis" ‚Üí Time taken.</li>
                    </ul>
                    <p>
                        Use explain plans to check if queries are using indexes effectively.
                    </p>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What is the aggregation pipeline in MongoDB?
                </div>
                <div class="answer">
                    <p>The aggregation pipeline in MongoDB is a framework for data aggregation and transformation</p>

                    <ul>
                        <li>It processes documents in a collection through a sequence of stages.</li>
                        <li>Each stage transforms the documents and passes the results to the next stage.</li>
                        <li>Similar to SQL‚Äôs GROUP BY, JOIN, ORDER BY, etc., but in a pipeline form.</li>
                    </ul>
                    <p>
                        Think of it like a factory assembly line ‚Üí raw data goes in, each stage modifies it, and at the end you get the desired output.
                    </p>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    Explain the difference between aggregate() and find().
                </div>
                <div class="answer">
                    <table>
                        <thead>
                            <tr>
                                <th>Features</th>
                                <th>find()</th>
                                <th>aggregate()</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Purpose</td>
                                <td>Retrieve documents (simple queries)</td>
                                <td>Perform complex transformations & analytics</td>
                            </tr>
                            <tr>
                                <td>Operations</td>
                                <td>Filtering, projection, sorting</td>
                                <td>Filtering, grouping, joining, calculations, reshaping</td>
                            </tr>
                            <tr>
                                <td>Output</td>
                                <td>Raw documents</td>
                                <td>Transformed/aggregated documents</td>
                            </tr>
                            <tr>
                                <td>Example</td>
                                <td><code>db.orders.find({ status: "completed" })</code></td>
                                <td><code>db.orders.aggregate([{$group: { _id: "$customerId", total: { $sum: "$amount" } } }])</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>üí° Rule of thumb:</h4>
                    <ul>
                        <li>
                            Use find() for simple queries.
                        </li>
                        <li>
                            Use aggregate() when you need grouping, joining, calculations, or analytics.
                        </li>
                    </ul>

                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What are common aggregation stages like $match, $group, $sort, $project, $lookup, $unwind?
                </div>
                <div class="answer">
                    <ul>
                        <li>
                            1. $match ‚Üí Filters documents (like WHERE in SQL).
                            <pre>{ $match: { status: "completed" } }</pre>
                        </li>
                        <li>
                            2. $group ‚Üí Groups documents by a field and performs aggregations (like GROUP BY).
                            <pre>{ $group: { _id: "$customerId", totalAmount: { $sum: "$amount" } } }</pre>
                        </li>
                        <li>
                            3. $sort ‚Üí Sorts documents.
                            <pre>{ $sort: { totalAmount: -1 } } // descending</pre>
                        </li>
                        <li>
                            4. $project ‚Üí Selects/re-shapes fields (like SELECT ...)
                            <pre>{ $project: { customerId: 1, totalAmount: 1, _id: 0 } }</pre>
                        </li>
                        <li>
                            5. $lookup ‚Üí Performs a left outer join with another collection.
                            <pre>
{ 
    $lookup: {
        from: "customers",        // collection to join
        localField: "customerId", // field in current collection
        foreignField: "_id",      // field in joined collection
        as: "customerInfo"        // output array field
    }
}
                            </pre>
                        </li>
                        <li>
                            6. $unwind ‚Üí Deconstructs an array field into multiple documents (like flattening).
                            <pre>{ $unwind: "$items" }</pre>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    How do you join two collections in MongoDB? ($lookup)
                </div>
                <div class="answer">
                    <p>
                        MongoDB doesn‚Äôt have joins like SQL, but $lookup stage allows you to combine documents from different collections.
                    </p>

                    <h4>üìå Example:</h4>
                    <pre>
<h3>orders collection</h3>
{ "_id": 1, "customerId": 101, "amount": 500 }
{ "_id": 2, "customerId": 102, "amount": 300 }

<h3>customers collection</h3>
{ "_id": 101, "name": "Alice" }
{ "_id": 102, "name": "Bob" }

<h3>Aggregation query:</h3>
db.orders.aggregate([
  {
    $lookup: {
      from: "customers",        // collection to join
      localField: "customerId", // field in orders
      foreignField: "_id",      // field in customers
      as: "customerInfo"        // alias for joined docs
    }
  }
]);

<h3>Output:</h3>
{
  "_id": 1,
  "customerId": 101,
  "amount": 500,
  "customerInfo": [ { "_id": 101, "name": "Alice" } ]
}
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    Write an aggregation query to count the number of orders per customer.
                </div>
                <div class="answer">
                    <pre>
<h3>Suppose you have orders collection:</h3>
{ "_id": 1, "customerId": 101, "amount": 500 }
{ "_id": 2, "customerId": 102, "amount": 300 }

<h3>Aggregation query:</h3>
db.orders.aggregate([
    {
        $group: {
            _id: "$customerId",        // group by customerId
            orderCount: { $sum: 1 }    // count orders
        }
    },
    {
        $sort: { orderCount: -1 }    // sort by order count desc
    }
]);

<h3>Output:</h3>
{ "_id": 101, "orderCount": 2 }
{ "_id": 102, "orderCount": 1 }
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    How do you design a schema in MongoDB?
                </div>
                <div class="answer">
                    <ul>
                        <li>Unlike relational databases (MySQL/PostgreSQL) which are schema-first (tables, fixed columns, strict types), MongoDB is schema-flexible</li>
                        <li>Schema design depends on how your application queries and updates data</li>
                        <li>General guidelines:</li>
                            <p>Understand the query patterns first (read-heavy, write-heavy, analytical).</p>
                            <p>Choose between embedding vs. referencing based on relationships.</p>
                            <p>Use indexes for fast query access.</p>
                            <p>Consider document size limits (16MB max per document).</p>
                    </ul>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What is the difference between embedding and referencing documents?
                </div>
                <div class="answer">
                    <h4>Embedding (Denormalization)</h4>
                    <p>Store related data in the same document (nested objects/arrays).</p>

                    <h4>Example:</h4>
                    <pre>
{
    _id: 1,
    name: "Alice",
    orders: [
        { orderId: 101, product: "Laptop", price: 1000 },
        { orderId: 102, product: "Phone", price: 500 }
    ]
}
                    </pre>
                    <p>‚úÖ Pros: Fast reads, single query, simple structure.</p>
                    <p>‚ùå Cons: Document size can grow very large, duplicates data.</p>

                    <hr>
                    <h4>Referencing (Normalization)</h4>
                    <p>Store related data in different collections, connect with _id.</p>

                    <h4>Example:</h4>
                    <pre>
// users
{ _id: 1, name: "Alice" }

// orders
{ _id: 101, userId: 1, product: "Laptop", price: 1000 }
                    </pre>
                    <p>‚úÖ Pros: No large documents, avoids duplication, flexible.</p>
                    <p>‚ùå Cons: Requires $lookup (join) or multiple queries.</p>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    When should you embed vs. reference?
                </div>
                <div class="answer">
                    <h4>Embed when:</h4>
                    <ul>
                        <li>
                            Data is accessed together most of the time.
                        </li>
                        <li>
                            Relationship is one-to-few (e.g., blog post with comments).
                        </li>
                        <li>
                            Document size won‚Äôt grow beyond MongoDB‚Äôs 16MB limit.
                        </li>
                    </ul>

                    <h4>Reference when:</h4>
                    <ul>
                        <li>
                            Relationship is one-to-many or many-to-many.
                        </li>
                        <li>
                            Data is large or frequently updated separately.
                        </li>
                        <li>
                            You don‚Äôt always need the related data in queries.
                        </li>
                    </ul>

                    <h4>üëâ Rule of thumb:</h4>
                    Embed for performance (fast reads), Reference for flexibility (avoid duplication).
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What are the advantages of a denormalized schema in MongoDB?
                </div>
                <div class="answer">
                    <p>Denormalization = storing related data in the same document.</p>
                    <ul>
                        <li>
                            <strong>Fewer queries</strong> ‚Üí Data is retrieved in one go.
                        </li>
                        <li>
                            <strong>Better read performance</strong> ‚Üí No joins required.
                        </li>
                        <li>
                            <strong>Simpler queries</strong> ‚Üí No need for multiple collections lookups.
                        </li>
                        <li>
                            Fits MongoDB‚Äôs document model naturally.
                        </li>
                    </ul>

                    <h4>Example</h4>
                    <pre>
Instead of joining users and addresses, store address inside user:

{
    name: "Alice",
    email: "alice@gmail.com",
    address: { city: "Delhi", country: "India" }
}
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    Does MongoDB support ACID transactions? If yes, from which version?
                </div>
                <div class="answer">
                    <p>Yes, MongoDB supports ACID transactions.</p>
                    <ul>
                        <li>ACID ‚Üí Atomicity, Consistency, Isolation, Durability.</li>
                        <li>Transactions allow multiple operations across multiple documents/collections to be executed as a single unit (all succeed or all fail).</li>
                        <li>MongoDB 4.0 ‚Üí Multi-document transactions in replica sets.</li>
                        <li>MongoDB 4.2 ‚Üí Transactions extended to sharded clusters.</li>
                    </ul>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    How do you start a multi-document transaction in MongoDB?
                </div>
                <div class="answer">
                    <p>To use transactions</p>
                    <ul>
                        <li>Start a session</li>
                        <li>Start a transaction</li>
                        <li>Run operations inside the transaction.</li>
                        <li>Commit or abort.</li>
                    </ul>

                    <h4>Example:</h4>
                    <pre>
// Start a session
const session = db.getMongo().startSession();

// Start transaction
session.startTransaction();

try {
    const usersCollection = session.getDatabase("test").users;
    const ordersCollection = session.getDatabase("test").orders;

    // Multiple operations
    usersCollection.updateOne(
        { _id: 1 },
        { $inc: { balance: -100 } }
    );
    ordersCollection.insertOne(
        { orderId: 101, userId: 1, amount: 100 }
    );

    // Commit transaction
    session.commitTransaction();
} catch (e) {
    // Rollback
    session.abortTransaction();
}
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    Explain replica sets and sharding in MongoDB.
                </div>
                <div class="answer">
                    <h3>Sharding</h3>
                    <ul>
                        <li>Splitting a big collection of data into smaller pieces and storing them across multiple servers (shards).</li>
                        <li>Each shard only holds a portion of the data.</li>
                        <li>Together, they make up the whole database.</li>
                    </ul>

                    <h4>üîë Components of Sharding in MongoDB:</h4>
                    <ul>
                        <li>
                            Shard - The actual database server that stores some portion of your data. (like a notebook)
                        </li>
                        <li>
                            Config Server - Stores the "map" (metadata) of where each piece of data lives. (like an index telling you which notebook has which info)
                        </li>
                        <li>
                            Query Router (mongos) - The middleman. When you ask for some data, it looks at the config server and directs your query to the correct shard(s). (like an assistant who fetches the right notebook for you)
                        </li>
                        <li>
                            Shard Key - A specific field in your documents that determines how data is distributed across shards. (like a label on each notebook that helps the assistant know where to find it)
                            <h4>Example</h4>
                            <p>If you have a users collection and choose "userId" as the shard key, all documents with userId 1 might go to Shard A, userId 2 to Shard B, and so on.</p>
                        </li>
                    </ul>

                    <hr>

                    <h3>Replica Sets</h3>
                    <ul>
                        <li>A replica set is a group of MongoDB servers that maintain the same data set, providing redundancy and high availability.</li>
                        <li>One primary node handles all write operations, while secondary nodes replicate the data from the primary and can handle read operations.</li>
                        <li>If the primary node fails, one of the secondary nodes is automatically elected as the new primary.</li>
                    </ul>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    How do you perform pagination in MongoDB? (skip and limit)
                </div>
                <div class="answer">
                    <p>Pagination is used to display data page by page (like in an eCommerce product listing)
                    MongoDB provides:</p>
                    <ul>
                        <li>
                            skip(n) ‚Üí Skips the first n documents.
                        </li>
                        <li>
                            limit(n) ‚Üí Limits the number of documents returned.
                        </li>
                    </ul>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    What is the drawback of using skip() for large collections?
                </div>
                <div class="answer">
                    <p>Performance issue: skip(n) still scans through the first n documents before discarding them.</p>
                    
                    <h4>Solution:</h4>
                    <ul>
                        <li>Use range-based pagination instead of skip/limit for large datasets.</li>
                        <li>Keep track of the last seen value (like _id or a timestamp) and query for documents greater than that value.</li>
                        <li>This avoids the overhead of skipping documents and is more efficient.</li>
                    </ul>

                    <h4>Example:</h4>
                    <pre>
db.products.find({ _id: { $gt: lastSeenId } }).limit(10);
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    How do you implement soft deletes in MongoDB?
                </div>
                <div class="answer">
                    <p>Performance issue: skip(n) still scans through the first n documents before discarding them.</p>
                    <h4>Example:</h4>
                    <pre>
// üëâ Schema Example:
{
    "_id": 1,
    "name": "Product A",
    "deleted": false
}

üëâ Mark as deleted:
db.products.updateOne({ _id: 1 }, { $set: { deleted: true } });
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    How do you implement full-text search in MongoDB?
                </div>
                <div class="answer">
                    <h4>Example:</h4>
                    <pre>
üëâ Create a text index:
db.articles.createIndex({ content: "text", title: "text" });

üëâ Search:
db.articles.find({ $text: { $search: "mongodb database" } });
                    </pre>

                    <ul>
                        <li>Supports stemming (searching ‚Äúrun‚Äù also finds ‚Äúrunning‚Äù).</li>
                        <li>Ignores stop words (‚Äúa‚Äù, ‚Äúthe‚Äù, etc.).</li>
                    </ul>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    Query for Find the Top 5 Highest-Paid Employees
                </div>
                <div class="answer">
                    <pre>
db.employees.find()
   .sort({ salary: -1 })   // sort by salary descending
   .limit(5)     
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    Query for Aggregation: Group Orders by Status and Count
                </div>
                <div class="answer">
                    <pre>
db.orders.aggregate([
   {
      $group: {
         _id: "$status",          // group by order status
         totalOrders: { $sum: 1 } // count each order
      }
   }
])   
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    Query for finding Products with price > 100 and category electronics/clothing
                </div>
                <div class="answer">
                    <pre>
db.products.find({
   price: { $gt: 100 },
   category: { $in: ["electronics", "clothing"] }
})  
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    Query for Update All Inactive Users ‚Üí Archived
                </div>
                <div class="answer">
                    <pre>
db.users.updateMany(
   { status: "inactive" },       // filter
   { $set: { status: "archived"} } // update
) 
                    </pre>
                </div>
            </div>

            <div class="qa-item">
                <div class="question" onclick="toggleAnswer(this)">
                    Query for Transaction: Move Money Between Accounts
                </div>
                <div class="answer">
                    <pre>
const session = db.getMongo().startSession();

try {
    session.startTransaction();

    const accounts = session.getDatabase("bank").accounts;

    // Deduct from sender
    accounts.updateOne(
        { accountNumber: "A123" },
        { $inc: { balance: -100 } }
    );

    // Add to receiver
    accounts.updateOne(
        { accountNumber: "B456" },
        { $inc: { balance: 100 } }
    );

    // Commit transaction
    session.commitTransaction();
    print("Transaction successful");
} catch (e) {
    session.abortTransaction();
    print("Transaction failed: " + e);
} finally {
    session.endSession();
}
                    </pre>
                </div>
            </div>



        </div>

        <script>
            document.querySelectorAll('.question').forEach((question) => {
                question.addEventListener('click', () => {
                    // Optional: close all others (accordion effect)
                    document.querySelectorAll('.question').forEach(q => {
                        if (q !== question) q.classList.remove('active');
                    });

                    document.querySelectorAll('.answer').forEach(a => {
                        if (a !== question.nextElementSibling) a.classList.remove('show');
                    });

                    // Toggle current
                    question.classList.toggle('active');
                    const answer = question.nextElementSibling;
                    answer.classList.toggle('show');
                });
            });
        </script>
    </body>
</html>
